<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.css">
		<link rel="stylesheet" href="style.css">
		<title>eGabinet - harmonogram</title>
	</head>
	<body>
		<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/locale/bootstrap-table-pl-PL.min.js"></script>

		<script src="door_opener.js"></script>

		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<a class="navbar-brand" href="index.html">
				<img src="favicon.png" width="50" height="50" alt="">
			</a>
			<a class="navbar-brand" href="index.html">
				eGabinet
			</a>

			<div class="collapse navbar-collapse">
				<ul class="navbar-nav mr-auto">
				</ul>
				<ul class="navbar-nav">
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Witaj, <span id="1st-2nd-name">Pan Użyszkodnik</span>
						</a>
						<div class="dropdown-menu" aria-labelledby="navbarDropdown">
							<a class="dropdown-item" href="profile.html">Profil użytkownika</a>
							<a class="dropdown-item" onclick="logout()" href="#">Wyloguj</a>
						</div>
					</li>
				</ul>
			</div>
		</nav>

		<div class="container-fluid" style="margin-top: 15px; padding-bottom: 15px;">

			<div id="edit-videocall" class="blank-div">
				<div class="card edit-user">
					<div class="card-header">
						<b>Wizyta</b>
					</div>
					<div class="card-body">
						<div class="input-group mb-3">
							<div class="input-group-prepend">
								<span class="input-group-text">ID wizyty</span>
							</div>
							<input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" disabled id="videocall-id">
						</div>
						<div class="input-group mb-3">
							<div class="input-group-prepend">
								<span class="input-group-text">Data</span>
							</div>
							<input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" placeholder="DD.MM.RRRR" id="videocall-date">
						</div>
						<div class="input-group mb-3" >
							<div class="input-group-prepend">
								<span class="input-group-text">Czas rozpoczęcia</span>
							</div>
							<input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" placeholder="HH:MM" id="videocall-start">
						</div>
						<div class="input-group mb-3" >
							<div class="input-group-prepend">
								<span class="input-group-text">Czas zakończenia</span>
							</div>
							<input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" placeholder="HH:MM" id="videocall-stop">
						</div>
						<div class="input-group mb-3">
							<div class="input-group-prepend">
								<label class="input-group-text" for="rola">Rehabilitant</label>
							</div>
							<select class="custom-select" name="rola" id="videocall-rehab">
								<option value=0>Grzegorz Tarnowski</option>
							</select>
						</div>
						<div class="input-group mb-3">
							<div class="input-group-prepend">
								<label class="input-group-text" for="rola">Pacjenci<br/>(przytrzymaj CTRL,<br/>aby zaznaczyć kilku)</label>
							</div>
							<select multiple class="form-control">
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
								<option value="1">Sebastian Kowalski</option>
								<option value="2">Piotr Nowak</option>
							</select>
						</div>
					</div>
					<div class="card-footer" style="padding: 15px;">
						<button type="button" class="btn btn-sm btn-outline-primary" onclick="closeEditWindow(true)">Zapisz</button>
						<button type="button" class="btn btn-sm btn-outline-secondary" onclick="closeEditWindow(false)">Anuluj</button>
						<button type="button" class="btn btn-sm btn-outline-danger" onclick="removeVideocall(); closeEditWindow(false);">Usuń</button>
					</div>
				</div>
			</div>

			<div class="card">
				<div class="card-header">
					<b>Harmonogram</b>
				</div>
				<div class="card-body" style="padding: 0px;">

					<table id="table" class="table" style="margin: 0px;">
						<thead>
							<tr>
								<th scope="col">ID</th>
								<th scope="col">Data</th>
								<th scope="col">Czas rozpoczęcia</th>
								<th scope="col">Czas zakończenia</th>
								<th scope="col">Rehabilitant</th>
								<th scope="col">Edycja</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">1</th>
								<td>06.07.2018</td>
								<td>10:00</td>
								<td>10:30</td>
								<td>Grzegorz Tarnowski</td>
								<td>
									<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(this)">Edytuj</button>
								</td>
							</tr>
							<tr>
								<th scope="row">2</th>
								<td>06.07.2018</td>
								<td>10:30</td>
								<td>11:00</td>
								<td>Grzegorz Tarnowski</td>
								<td>
									<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(this)">Edytuj</button>
								</td>
							</tr>
							<tr>
								<th scope="row">3</th>
								<td>06.07.2018</td>
								<td>11:00</td>
								<td>11:30</td>
								<td>Grzegorz Tarnowski</td>
								<td>
									<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(this)">Edytuj</button>
								</td>
							</tr>
							<tr>
								<th scope="row">4</th>
								<td>06.07.2018</td>
								<td>11:30</td>
								<td>12:00</td>
								<td>Grzegorz Tarnowski</td>
								<td>
									<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(this)">Edytuj</button>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<div class="card-footer" style="padding: 15px;">
					<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(false)">Dodaj wizytę</button>
				</div>
			</div>



			<script>
				//	get user role from cookie

				//	if patient
				//		document.location.href = "index.html";

				function openEditWindow(button) {
					if (button) {
						// existing user
						var row = button.parentNode.parentNode;
						var id = row.cells[0].innerHTML;
						var date = row.cells[1].innerHTML;
						var start = row.cells[2].innerHTML;
						var stop = row.cells[3].innerHTML;
						//rehab
						$('#videocall-id').val(id);
						$('#videocall-date').val(date);
						$('#videocall-start').val(start);
						$('#videocall-stop').val(stop);
					}
					else {
						$('#videocall-id').val("");
						$('#videocall-date').val("");
						$('#videocall-start').val("");
						$('#videocall-stop').val("");
					}
					$('#edit-videocall').show();
				}

				function closeEditWindow(save) {
					if (save) {
						var id = $('#videocall-id').val();
						var date = $('#videocall-date').val();
						var start = $('#videocall-start').val();
						var stop = $('#videocall-stop').val();
						//rehab
						var existing_visit = false;

						var table = document.getElementById('table');
						for (var r = 0, n = table.rows.length; r < n; r++) {
							var cells = table.rows[r].cells;
							if (cells[0].innerHTML == id) {
								existing_visit = true;
								cells[1].innerHTML = date;
								cells[2].innerHTML = start;
								cells[3].innerHTML = stop;
							}
						}
						if (!existing_visit) {
							var row = table.insertRow(table.rows.length);
							row.appendChild(document.createElement("th")).innerHTML = "newID";
							row.insertCell(1).innerHTML = date;
							row.insertCell(2).innerHTML = start;
							row.insertCell(3).innerHTML = stop;
							row.insertCell(4).innerHTML = "////rehab...";
							row.insertCell(5).innerHTML = '<button type="button" class="btn btn-sm btn-outline-primary" onclick="openEditWindow(this)">Edytuj</button>';
						}
					}
					$('#edit-videocall').hide();
				}

				function removeVideocall () {
					var id = $('#videocall-id').val();
					var table = document.getElementById('table');
						for (var r = 0, n = table.rows.length; r < n; r++) {
							if (table.rows[r].cells[0].innerHTML == id) {
								table.deleteRow(r);
								break;
							}
						}
				}
			</script>

			
		</div>
	</body>
</html>